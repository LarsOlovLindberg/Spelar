# Output directory on VPS (the agent writes files here)
OUT_DIR=/opt/spelar_eu/vps/out
INTERVAL_S=15

# Strategy mode:
# - fair_model: existing PM price vs fair_p (Deribit/Kraken futures) logic
# - lead_lag: Kraken spot leads, PM CLOB lags (entry/exit on lead–lag edge)
STRATEGY_MODE=lead_lag

# Public endpoints (examples — replace with what you actually want to ingest)
# POLYMARKET_PUBLIC_URL=https://...
# KRAKEN_PUBLIC_URL=https://...

# Polymarket CLOB (public)
POLYMARKET_CLOB_BASE_URL=https://clob.polymarket.com
# Required to compute a simple edge from orderbook:
# POLYMARKET_CLOB_TOKEN_ID=...

# Kraken spot (lead_lag)
KRAKEN_SPOT_BASE_URL=https://api.kraken.com/0/public
KRAKEN_SPOT_PAIR=XBTUSD

# Lead–lag params (percent units, e.g. 0.25 means 0.25%)
LEAD_LAG_SIDE=YES
LEAD_LAG_LOOKBACK_POINTS=6
LEAD_LAG_SPOT_MOVE_MIN_PCT=0.25
LEAD_LAG_EDGE_MIN_PCT=0.20
LEAD_LAG_EDGE_EXIT_PCT=0.05
LEAD_LAG_MAX_HOLD_SECS=180
LEAD_LAG_PM_STOP_PCT=0.25
LEAD_LAG_AVOID_PRICE_ABOVE=0.90
LEAD_LAG_AVOID_PRICE_BELOW=0.02

# After-cost / microstructure quality gates (recommended to keep these ON)
# - `LEAD_LAG_SPREAD_COST_CAP_PCT` blocks entries when spread cost is too high.
# - `LEAD_LAG_NET_EDGE_MIN_PCT` requires edge to survive spread+fees.
LEAD_LAG_NET_EDGE_MIN_PCT=0.08
LEAD_LAG_SPREAD_COST_CAP_PCT=0.75
LEAD_LAG_MIN_TRADE_NOTIONAL_USDC=10

# Adaptive move gating (noise + spread proxy)
LEAD_LAG_SPOT_NOISE_WINDOW_POINTS=40
LEAD_LAG_SPOT_NOISE_MULT=2.0
LEAD_LAG_SPREAD_MOVE_MULT=1.0

# Optional: require measured PM lag (only blocks when lag is known)
LEAD_LAG_MIN_MARKET_LAG_MS=0

# Profit-first (more selective) – uncomment to reduce overtrading
# LEAD_LAG_LOOKBACK_POINTS=8
# LEAD_LAG_SPOT_MOVE_MIN_PCT=0.35
# LEAD_LAG_EDGE_MIN_PCT=0.30
# LEAD_LAG_EDGE_EXIT_PCT=0.10
# LEAD_LAG_MAX_HOLD_SECS=240
# LEAD_LAG_PM_STOP_PCT=0.30
# LEAD_LAG_AVOID_PRICE_ABOVE=0.85
# LEAD_LAG_AVOID_PRICE_BELOW=0.03
# LEAD_LAG_NET_EDGE_MIN_PCT=0.12
# LEAD_LAG_SPREAD_COST_CAP_PCT=0.50
# LEAD_LAG_MIN_TRADE_NOTIONAL_USDC=25

# Lead–lag orderbook sizing (caps entry size by visible band liquidity)
LEAD_LAG_ENABLE_ORDERBOOK_SIZING=1
LEAD_LAG_SLIPPAGE_CAP=0.01
LEAD_LAG_MAX_FRACTION_OF_BAND_LIQUIDITY=0.10
LEAD_LAG_HARD_CAP_USDC=2000

# Drift safety: require fresh inputs (seconds) before entering/exiting
FRESHNESS_MAX_AGE_SECS=60

# Polymarket CLOB (LIVE trading) – disabled unless TRADING_MODE=live AND POLY_LIVE_CONFIRM=YES
# Requires installing 'py-clob-client' on the VPS and providing both L1 + L2 auth.
# L1: signer private key (used only to sign orders locally)
# POLY_PRIVATE_KEY=0x...
# L2: API credentials (generated via Polymarket client)
# POLY_CLOB_API_KEY=...
# POLY_CLOB_SECRET=...
# POLY_CLOB_PASS_PHRASE=...
# Chain id: Polygon mainnet (137) by default
# POLY_CHAIN_ID=137
# Signature type: 0=EOA, 1=POLY_PROXY, 2=GNOSIS_SAFE
# POLY_SIGNATURE_TYPE=0
# Funder address (often same as signer for EOA; for proxy/safe use the funder/proxy wallet address)
# POLY_FUNDER=
# Extra hard gate to prevent accidental live trading
# POLY_LIVE_CONFIRM=NO
# Basic order sizing (shares)
# PM_ORDER_SIZE_SHARES=10
# PM_MAX_ORDERS_PER_TICK=1

# Optional (recommended for live safety): user-channel websocket + periodic reconcile.
# This lets the agent observe fills/position changes directly instead of assuming.
# POLY_WSS_URL=wss://ws-subscriptions-clob.polymarket.com/ws/
# PM_USER_WSS_ENABLE=1
# PM_USER_RECONCILE_INTERVAL_S=60

# Kraken Futures (public/private)
# Example: PF_XBTUSD
# KRAKEN_FUTURES_SYMBOL=PF_XBTUSD
# Use demo-futures.kraken.com
KRAKEN_FUTURES_TESTNET=0
# If you want the agent itself to verify private connectivity (paper-first):
# KRAKEN_KEYS_PATH=/etc/spelar_eu/kraken_keys.local.json

# Paper signal threshold (absolute value)
EDGE_THRESHOLD=0.02

# Optional: market mapping file that ties PM token <-> Kraken symbol <-> fair model.
# IMPORTANT: do not leave this pointing at an old, expired map; set it explicitly.
# If unset, the agent will fall back to the single env-market (POLYMARKET_CLOB_TOKEN_ID).
# MARKET_MAP_PATH=/opt/spelar_eu/vps/market_map.example.json

# Optional: use Gamma scan output as the active market universe (instead of a static MARKET_MAP_PATH).
# This works in paper mode and is the recommended way to avoid “old markets” drift.
# PM_SCAN_ENABLE=1
# PM_SCAN_ACTIVE_ONLY=1
# PM_SCAN_BINARY_ONLY=1
# PM_SCAN_USE_FOR_TRADING=1
# PM_SCAN_TRADE_MAX_MARKETS=20
# Optional: focus the scan (e.g. "bitcoin", "eth", "election")
# PM_SCAN_SEARCH=bitcoin

# Optional: upload the portal-facing files to your hosted webroot
# If you prefer to keep FTP creds only on your local machine, leave this commented
# and instead use scripts/sync-vps-stats.ps1 + scripts/deploy-ftp.ps1.
# FTP_HOST=spelar.eu
# FTP_USER=YOUR_FTP_USERNAME
# FTP_PASS=YOUR_FTP_PASSWORD
# FTP_REMOTE_DIR=/web/data
# Protocol:
# - ftp (port 21): may be blocked from some VPS/DC IPs
# - sftp (port 22): recommended when available (spelar.eu supports mod_sftp)
# FTP_PROTOCOL=sftp
# FTP_PORT=22

# Recommended alternative (no FTP/SFTP): HTTPS POST upload endpoint.
# Deploy the PHP endpoint under web/trading/api/upload_stats.php on the web host.
# UPLOAD_URL should be a full URL and can include query params (e.g. ?type=futures)
# UPLOAD_URL=https://spelar.eu/trading/api/upload_stats.php
# UPLOAD_API_KEY=YOUR_RANDOM_LONG_SECRET

# Safety defaults
TRADING_MODE=paper
# Create this file to force-disable any live actions
KILLSWITCH_FILE=/opt/spelar_eu/vps/out/KILLSWITCH
